<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Coffee Dashboard</title>
    <link rel="stylesheet" href="styles.css" />
    <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js" defer></script>
    <script src="https://cdn.plot.ly/plotly-2.35.2.min.js" defer></script>
    <script src="https://d3js.org/d3.v7.min.js" defer></script>
    <script src="https://cdn.jsdelivr.net/npm/d3-cloud@1.2.7/build/d3.layout.cloud.min.js" defer></script>
    <script src="app.js" defer></script>
  </head>
  <body>
    <header class="hero">
      <h1>L&B Coffee Report</h1>
    </header>

    <main>
      <h3 class="group-title">Rankings</h3>
      <section class="card top-coffee-card">
        <div class="section-header">
          <h2>Top Coffee</h2>
          <p id="topCoffeeSubtitle">Ranked by overall rating</p>
        </div>
        <div id="topCoffeeRankTable" class="table-scroll table-scroll-xl"></div>
        <button id="toggleTopCoffeeRank" class="mini-btn" type="button">Show All</button>
      </section>
      <section class="card decaf-coffee-card">
        <div class="section-header">
          <h2>Decaf Rankings</h2>
          <p>Decaf coffees only, ranked by overall rating</p>
        </div>
        <div id="decafRankTable" class="table-scroll table-scroll-lg"></div>
      </section>

      <section class="collapsible-section" data-collapsible>
        <button class="collapsible-toggle" type="button" aria-expanded="false">By Coffee Origin üåç</button>
        <div class="collapsible-content">
          <section class="grid-2 stack-vertical">
            <section class="card">
              <div class="section-header">
                <h2>Top Origin Countries</h2>
                <p>Ranked by average rating. Decaf excluded.</p>
              </div>
              <div id="countryRankTable" class="table-scroll table-scroll-sm"></div>
              <button id="toggleCountryRank" class="mini-btn" type="button">Show All</button>
            </section>
          </section>
          <section class="card">
            <div class="section-header">
              <h2>Ratings by Coffee Origin</h2>
              <p>Country-level average rating and tasting counts</p>
            </div>
            <div id="mapChart" class="plot"></div>
          </section>
          <section class="grid-2 stack-vertical">
            <section class="card">
              <div class="section-header">
                <h2>Origin Deep Dive</h2>
                <p>Click a country in the map or ranking table to see coffees</p>
              </div>
              <div id="originRegionDetails" class="table-scroll"></div>
            </section>
          </section>
        </div>
      </section>

      <section class="collapsible-section" data-collapsible>
        <button class="collapsible-toggle" type="button" aria-expanded="false">By Roaster Location üî•</button>
        <div class="collapsible-content">
          <section class="grid-2 stack-vertical">
            <section class="card">
              <div class="section-header">
                <h2>Top Roaster Locations</h2>
                <p>US states for US roasters, countries otherwise. Decaf excluded.</p>
              </div>
              <div id="roasterRankTable" class="table-scroll table-scroll-sm"></div>
              <button id="toggleRoasterRank" class="mini-btn" type="button">Show All</button>
            </section>
          </section>
          <section class="grid-2">
            <section class="card">
              <div class="section-header">
                <h2>Roaster US State Map</h2>
                <p>Average rating by US state from roaster location</p>
              </div>
              <div id="roasterMapChart" class="plot"></div>
            </section>
            <section class="card">
              <div class="section-header">
                <h2>Roaster Country Map</h2>
                <p>Average rating by roaster country</p>
              </div>
              <div id="roasterCountryMapChart" class="plot"></div>
            </section>
          </section>
          <section class="grid-2 stack-vertical">
            <section class="card">
              <div class="section-header">
                <h2>Roaster Region Drilldown</h2>
                <p>Click a state or country above to see coffees from that region</p>
              </div>
              <div id="roasterRegionDetails" class="table-scroll"></div>
            </section>
          </section>
        </div>
      </section>

      <section class="collapsible-section" data-collapsible>
        <button class="collapsible-toggle" type="button" aria-expanded="false">By Varietal &amp; Process ü´ò</button>
        <div class="collapsible-content">
          <section class="grid-2">
            <section class="card">
              <div class="section-header">
                <h2>Varietal Analysis</h2>
                <p>Standardized common varietals, ranked by average rating</p>
              </div>
              <div id="varietalChart" class="plot"></div>
            </section>
            <section class="card">
              <div class="section-header">
                <h2>Process Analysis</h2>
                <p>Standardized processing methods by average rating</p>
              </div>
              <div id="processChart" class="plot"></div>
            </section>
          </section>
        </div>
      </section>

      <section class="collapsible-section" data-collapsible>
        <button class="collapsible-toggle" type="button" aria-expanded="false">By Year üìÖ</button>
        <div class="collapsible-content">
          <section class="grid-2">
            <section class="card">
              <div class="section-header">
                <h2>Coffees Tasted by Year</h2>
              </div>
              <div id="tastedChart" class="plot"></div>
            </section>
            <section class="card">
              <div class="section-header">
                <h2>Average Rating by Year</h2>
              </div>
              <div id="ratingsChart" class="plot"></div>
            </section>
          </section>
        </div>
      </section>

      <section class="collapsible-section" data-collapsible>
        <button class="collapsible-toggle" type="button" aria-expanded="false">Alex &amp; Rebecca üë•</button>
        <div class="collapsible-content">
          <section class="grid-2">
            <section class="card">
              <div class="section-header">
                <h2>Alex Ranking</h2>
                <p>Coffees ranked by Alex rating</p>
              </div>
              <div id="alexTop5Table" class="table-scroll"></div>
            </section>
            <section class="card">
              <div class="section-header">
                <h2>Rebecca Ranking</h2>
                <p>Coffees ranked by Rebecca rating</p>
              </div>
              <div id="rebTop5Table" class="table-scroll"></div>
            </section>
          </section>

          <section class="grid-2">
            <section class="card">
              <div class="section-header">
                <h2>Alex vs Rebecca by Coffee Origin</h2>
                <p>Average ratings for countries with enough paired tastings</p>
              </div>
              <div id="tasterCountryChart" class="plot"></div>
            </section>
            <section class="card">
              <div class="section-header">
                <h2>Alex vs Rebecca by Process</h2>
                <p>Average ratings for processes with enough paired tastings</p>
              </div>
              <div id="tasterProcessChart" class="plot"></div>
            </section>
          </section>

          <section class="card">
            <div class="section-header">
              <h2>Word Spectrum by Rating</h2>
              <p>Tasting-note terms only. 10 at top, 0 at bottom, Alex on left and Rebecca on right.</p>
            </div>
            <div class="spectrum-labels">
              <span>Alex</span>
              <span>Rebecca</span>
            </div>
            <div id="ratingWordSpectrumChart" class="plot"></div>
          </section>
        </div>
      </section>
    </main>

    <footer>
      <small id="sourceNote"></small>
    </footer>
  </body>
</html>
